export const TOTAL_STAGES = 35;

export const BRICK_LAYOUT_ROWS = 28;
export const BRICK_LAYOUT_COLS = 11;

export const SPEED_COUNTER_TABLE = [
  4, 10, 18, 28, 40, 54, 70, 88,
  108, 130, 154, 180, 208, 238, 270, 9999,
];

const SPEED_VALUES_BY_DIFFICULTY = {
  easy: [
    3.3, 3.55, 3.8, 4.05, 4.3, 4.55, 4.8, 5.05,
    5.3, 5.55, 5.8, 6.05, 6.3, 6.55, 6.8, 7.05,
  ],
  hard: [
    3.7, 3.95, 4.2, 4.45, 4.7, 4.95, 5.2, 5.45,
    5.7, 5.95, 6.2, 6.45, 6.7, 6.95, 7.2, 7.45,
  ],
};

export function speedValuesForDifficulty(difficulty) {
  return SPEED_VALUES_BY_DIFFICULTY[difficulty] || SPEED_VALUES_BY_DIFFICULTY.easy;
}

export function silverHitsForStage(stageNum) {
  return Math.max(1, Math.min(6, 1 + Math.floor((stageNum - 1) / 8)));
}

export function capsuleCountForStage(stageNum) {
  return Math.max(2, Math.min(8, 2 + Math.floor((stageNum - 1) / 5)));
}

// Imported from levels.js full 28x11 grid. Symbols: . empty, 1-8 normal, S silver, G gold.
const STAGE_ROWS = [
  [
    '...........',
    '...........',
    '...........',
    '...........',
    'SSSSSSSSSSS',
    '55555555555',
    '66666666666',
    '88888888888',
    '77777777777',
    '44444444444',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '2..........',
    '23.........',
    '234........',
    '2346.......',
    '23465......',
    '234652.....',
    '2346523....',
    '23465234...',
    '234652346..',
    '2346523465.',
    'SSSSSSSSSS2',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '44444444444',
    '...........',
    '111GGGGGGGG',
    '...........',
    '55555555555',
    '...........',
    'GGGGGGGG111',
    '...........',
    '77777777777',
    '...........',
    '666GGGGGGGG',
    '...........',
    '66666666666',
    '...........',
    'GGGGGGGG666',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '...........',
    '.S847.846S.',
    '.6485.48S6.',
    '.4758.6S84.',
    '.8574.S648.',
    '.5846.8475.',
    '.748S.4857.',
    '.46S8.7584.',
    '.8S64.5748.',
    '.S847.846S.',
    '.6485.48S6.',
    '.4758.6S84.',
    '.8574.S648.',
    '.5846.8475.',
    '.748S.4857.',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...8...8...',
    '....8.8....',
    '....8.8....',
    '...SSSSS...',
    '...SSSSS...',
    '..SS5S5SS..',
    '..SS5S5SS..',
    '.SSSSSSSSS.',
    '.SSSSSSSSS.',
    '.S.SSSSS.S.',
    '.S.S...S.S.',
    '.S.S...S.S.',
    '....S.S....',
    '....S.S....',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '6.5.4.4.5.6',
    '6.5.4.4.5.6',
    '6.5.4.4.5.6',
    '6.G2G2G2G.6',
    '6.5.4.4.5.6',
    '6.5.4.4.5.6',
    '6.5.4.4.5.6',
    '6.5.4.4.5.6',
    '6.5.4.4.5.6',
    '2.G.G.G.G.2',
    '6.5.4.4.5.6',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '...........',
    '....836....',
    '...84638...',
    '...36482...',
    '..4638452..',
    '..6482548..',
    '..3845284..',
    '..8254836..',
    '..4528463..',
    '..5483648..',
    '...84638...',
    '...36482...',
    '....384....',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '.G..G.G..G.',
    '.GG.....GG.',
    '.....2.....',
    '....G4G....',
    '..G..8..G..',
    '.....6.....',
    '..G..5..G..',
    '....G4G....',
    '.....8.....',
    '.GG.....GG.',
    '.G..G.G..G.',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '.G.G...G.G.',
    '.G4G...G4G.',
    '.G6G...G6G.',
    '.GGG...GGG.',
    '...........',
    '...76668...',
    '...74348...',
    '...73438...',
    '...74348...',
    '...73438...',
    '...76668...',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '.G.........',
    '...........',
    '.G.........',
    '.G.........',
    '.G....6....',
    '.G...636...',
    '.G..63636..',
    '.G.636S636.',
    '.G..63636..',
    '.G...636...',
    '.G....6....',
    '.G.........',
    '.G.........',
    '.G.........',
    '.G.........',
    '.GGGGGGGGGG',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '...........',
    '.SSSSSSSSS.',
    '.S.......S.',
    '.S.SSSSS.S.',
    '.S.S...S.S.',
    '.S.S.S.S.S.',
    '.S.S...S.S.',
    '.S.SSSSS.S.',
    '.S.......S.',
    '.SSSSSSSSS.',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    'GGGGGGGGGGG',
    '....G...G2.',
    '.G4.G...G..',
    '.G..G.G.G..',
    '.G..G.G.G..',
    '.G..G4G.G..',
    '.G.2G.G6G..',
    '.G..G5G.G..',
    '.G..G.G.G..',
    '.G..G.G.G..',
    '.G3...G....',
    '.G....G...2',
    '.GGGGGGGGGG',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '...........',
    '.88.111.88.',
    '.11.888.11.',
    '.66.555.66.',
    '.77.444.77.',
    '.44.777.44.',
    '.55.666.55.',
    '.88.111.88.',
    '.11.888.11.',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '5SSSSSSSSS5',
    'G.........G',
    '66666666666',
    '...........',
    '2SSSSSSSSS2',
    'G.........G',
    '66666666666',
    '...........',
    '6SSSSSSSSS6',
    'G.........G',
    '55555555555',
    '...........',
    '55555555555',
    'G.........G',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '3SS33333SS3',
    '3S8S333S4S3',
    '3S88SSS44S3',
    '3S888S444S3',
    '3S888S444S3',
    '3S888S444S3',
    '3S888S444S3',
    '3S888S444S3',
    '3S888S444S3',
    '33S88S44S33',
    '333S8S4S333',
    '3333SSS3333',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '.....G.....',
    '...11.11...',
    '.11..G..11.',
    '1..88.88..1',
    '.88..G..88.',
    '8..44.44..8',
    '.44..G..44.',
    '4..55.55..4',
    '.55..G..55.',
    '5..66.66..5',
    '.66..G..66.',
    '6..44.44..6',
    '.44.....44.',
    '4.........4',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '.....S.....',
    '...66S44...',
    '..6611144..',
    '.661111144.',
    '.661111144.',
    '.661111144.',
    '.S.S.S.S.S.',
    '.....S.....',
    '.....S.....',
    '...G.G.....',
    '...GGG.....',
    '....G......',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '2.G88888G.2',
    '2.GG888GG.2',
    '2.G.G8G.G.2',
    '2.G.4S4.G.2',
    '2.G.4.4.G.2',
    '2.G.4.4.G.2',
    '2.G.4.4.G.2',
    '2.G.4.4.G.2',
    '2.G.4.4.G.2',
    '2GGG4.4GGG2',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '..GGGGGGG..',
    '..456G654..',
    '..456G654..',
    '..456G654..',
    '..456G654..',
    '..456G654..',
    '..456G654..',
    '..456G654..',
    '..GGGGGGG..',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '4G2G3G4G7G2',
    '7GSGSGSGSG3',
    '..7........',
    '.G.G7G.G.G.',
    '.G.G.G7G.G.',
    '.G.G.G.G7G.',
    '...........',
    '.G.G.G7G.G.',
    '.G.G7G.G.G.',
    '..7G.G.G...',
    '7....G.....',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '.G2222222G.',
    '.G.......G.',
    '.G.GGGGG.G.',
    '.G.G666G.G.',
    '.G.G777G.G.',
    '.G.G444G.G.',
    '.G.G222G.G.',
    '.G.G333G.G.',
    '.G.......G.',
    '.G.......G.',
    '.GGGGGGGGG.',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '88888888888',
    '88888888888',
    '...........',
    '5G.G555G.G5',
    '5G.G555G.G5',
    '5G.G555G.G5',
    '5G.G555G.G5',
    '...........',
    '11111111111',
    '11111111111',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '66666666666',
    '...........',
    'SSS.SSS.SSS',
    'S4S.S4S.S4S',
    'SSS.SSS.SSS',
    '...........',
    '..SSS.SSS..',
    '..S5S.S5S..',
    '..SSS.SSS..',
    '...........',
    'SSS.SSS.SSS',
    'S6S.S6S.S6S',
    'SSS.SSS.SSS',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '....111....',
    '....111....',
    '....111....',
    '...16161...',
    '...66666...',
    '..6666666..',
    '..6666666..',
    '.666666666.',
    '66666666666',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '55555555555',
    '44444444444',
    '66666666666',
    'GGGG555GGGG',
    'G44GSSSG44G',
    'G55G...G66G',
    'G.........G',
    'G.........G',
    'G.........G',
    'G..G444G..G',
    'GSSGGGGGSSG',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '...........',
    '..GSSG.....',
    '.G....G....',
    'G..33..G...',
    'G.6666.G...',
    'G..77..G...',
    '.G....G....',
    '..GGGG.....',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    'SSSSSSSSSSS',
    '88888888888',
    'SSSSSSSSSSS',
    '...........',
    'SSSSSSSSSSS',
    '55555555555',
    'SSSSSSSSSSS',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '66666666666',
    '6GGG7G7GGG6',
    '6G.......G6',
    '6G7.....7G6',
    '6G77...77G6',
    '.6G77.77G6.',
    '..6G777G6..',
    '...6G7G6...',
    '....676....',
    '.....6.....',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '6666G.G6666',
    '4444G.G4444',
    'GGGGG.GGGGG',
    '7777G.G7777',
    '2222G.G2222',
    '6666G.G6666',
    'SSSSG.GSSSS',
    '2222G.G2222',
    '7777G.G7777',
    '4444G.G4444',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '...........',
    '27.........',
    '2734.......',
    '273427.....',
    '27342734...',
    'S734273427.',
    '.GS42734273',
    '...GS734273',
    '.....GS4273',
    '.......GS73',
    '.........GS',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '6.5.4.7.6.5',
    'S.S.S.S.S.S',
    '.4.5.6.2.4.',
    '.S.S.S.S.S.',
    '2.6.5.4.7.6',
    'S.S.S.S.S.S',
    '.7.4.5.6.2.',
    '.S.S.S.S.S.',
    '4.2.6.5.4.7',
    'S.S.S.S.S.S',
    '.6.7.4.5.6.',
    '.S.S.S.S.S.',
    '5.4.2.6.5.4',
    'S.S.S.S.S.S',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '..G.G.G.G..',
    '..G.G.G.G..',
    '..G.G.G.G..',
    '..G.G.G55..',
    '..G.G.G.G..',
    '..G.G6666..',
    '..G.G.G.G..',
    '..G555555..',
    '..G.G.G.G..',
    '..8888888..',
    '..SSSSSSS..',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '.....55....',
    '....5SS5...',
    '....5S55...',
    '....5555...',
    '....5555...',
    '....5555...',
    '...445556..',
    '..4SS55SS6.',
    '..4S446S66.',
    '..44446666.',
    '..44446666.',
    '..44446666.',
    '..44446666.',
    '...44..66..',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '...........',
    '...........',
    '...........',
    '......333..',
    '......337..',
    '.....33777.',
    '.....33376.',
    '.....33336.',
    '....G33336.',
    '....263366.',
    '....22666..',
    '...G2G666..',
    '...2222....',
    '..G2G2.....',
    '..2222.....',
    '..222......',
    '.222.......',
    '.22........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
  [
    '.........1.',
    '.........11',
    '...1111....',
    '....1111...',
    '.....GGG...',
    '..1........',
    '.121.......',
    '12G21......',
    '.121.......',
    '..1.......2',
    '..7..G.444.',
    '4.7.4.4.474',
    'G474.74G4..',
    'G474.4.244.',
    'GG4G4..44..',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
    '...........',
  ],
];

if (STAGE_ROWS.length !== TOTAL_STAGES) {
  throw new Error(`Expected ${TOTAL_STAGES} stage rows, got ${STAGE_ROWS.length}`);
}

export function getStageRows(stageNum) {
  const idx = Math.max(0, Math.min(TOTAL_STAGES - 1, Math.floor(stageNum) - 1));
  return STAGE_ROWS[idx];
}
